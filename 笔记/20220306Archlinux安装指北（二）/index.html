<!DOCTYPE html><html lang=zh-CN class=dark><head><title>悬铃木 | Archlinux安装指北（二）</title><meta http-equiv=content-type content="text/html; charset=utf-8"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name=renderer content=webkit><meta name=force-rendering content=webkit><meta name=description content="Lorre的网络日志，life is a fucking movie！"><meta name=keywords content=Lorre的梦呓><meta name=referrer content=no-referrer><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><meta http-equiv=Cache-Control content="no-cache, no-store, must-revalidate"><meta http-equiv=Pragma content=no-cache><meta http-equiv=Expires content=0><link rel=stylesheet href=/css/style.min.css><script src=/music/music.js defer=defer></script><script src=/js/main.js defer=defer></script><script src=/js/pjax.js></script><script src=/js/moment.js></script><meta name=generator content="Hexo 6.3.0"><link rel=alternate href=/atom.xml title=悬铃木 type=application/atom+xml></head><body class=""><div id=Henmin><header class=wrap><nav class=menu><span id=load><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 33 33"><path fill=var(--tx-se) d="M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z" opacity=.5 /><path fill=var(--bg-se) opacity=.5 d="M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"><animateTransform attributeName=transform dur=1s from="0 12 12" repeatCount=indefinite to="360 12 12" type=rotate /></path></svg></span><a class=menu-item href=/ ><span><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 100 100" version=1.1><title>home</title><desc>create by lorre.</desc><g stroke=#8A8A8A stroke-width=3 fill=none fill-rule=evenodd><polyline stroke-linecap=round stroke-linejoin=round points="17 51 50 21 82 51"/><polyline stroke-linecap=round stroke-linejoin=round points="27 51 27 79 43 79 43 60 50 60"></polyline><polyline stroke-linecap=round stroke-linejoin=round transform="translate(61, 65) scale(-1, 1) translate(-61, -65) " points="50 51 50 79 66 79 66 60 73 60"></polyline><path d="M45,60 L55,60" stroke-linecap=square /><polyline stroke-linecap=round stroke-linejoin=round points="59 24 73 24 73 37"/><path d="M41,40 L59,40" stroke-linecap=round><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=2.5s repeatCount=1 /></path><path d="M34,49 L65,49" stroke-linecap=round><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=1.5s repeatCount=1 /></path></g></svg> </span></a><a class=menu-item href=/archives><span><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 100 100" version=1.1><title>home</title><desc>create by lorre.</desc><g id=dtico stroke=#8A8A8A stroke-width=3 fill=none fill-rule=evenodd><rect x=17.5 y=17.5 width=65 height=65 /><path d="M33,67 L33,39 C33,30 39,24 48,24 L52,24 C60,24 67.5,30 67.5,39 L67.5,61"><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=0.6s repeatCount=1 /></path><path d="M73,81 C73,74 70,68 65,64 M58,60 C55,59 53,59 50,59 C38,59 28,68 27,81"><animate attributeName=stroke-dasharray from="0 150" to="150 150" dur=1.5s repeatCount=1 /></path><path d="M51,25.5 C55,28 58,33 58,39 C58,54 58,54 58,64 C61,64 64,64 67.5,64 L67.5,39 C67.5,31 61,25.5 54,25.5 L51,25.5 Z"/><path d="M34,38 C34,46 40,52.5 48.5,52.5" stroke-linecap=round stroke-linejoin=round /><path d="M35,38.5 L56.5,38.5" stroke-linecap=square /></g></svg> </span></a><a class=menu-item href=/tags><span><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 100 100" version=1.1><title>tag</title><desc>create by lorre.</desc><g stroke=#8A8A8A stroke-width=3 fill=none fill-rule=evenodd stroke-linecap=round><path d="M44,40 C41,35 37,31 33.5,31 C24,31 17,48 17,60 C17,69 21,77 33.5,77 L33.5,77 C41,77 46,73 48,68"/><path d="M63,73 C77,73 83,64 83,54 C83,38 73,17 63,17 C52,17 43,38 43,54 C43,64 48,73 63,73 Z"/><path d="M62,58 L51,52"><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=2s repeatCount=1></animate></path><path d="M32,66 L23,58"><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=2s repeatCount=1></animate></path><path d="M63,49 L68,44"><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=3s repeatCount=1></animate></path><path d="M33,57 L37,52"><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=3s repeatCount=1></animate></path><path d="M63,82 L63,37"/><path d="M33,82 L33,46"/></g></svg> </span></a><a class=menu-item href=/moment><span><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 100 100" version=1.1><title>mumbler</title><desc>create by lorre.</desc><g stroke=#8A8A8A stroke-width=3 fill=none fill-rule=evenodd><path d="M17,31 L17,21 C17,19 19,17 21,17 L65,17 C67,17 70,19 70,21 C70,26 70,48 70,51"/><path d="M70,50 C70,55 70,64 70,78 C70,80 67,83 65,83 L21,83 C19,83 17,80 17,78 L17,69"/><polyline points="17 60 17 40 17 39"></polyline><path d="M29.5,17 L29.5,81" stroke-linecap=square /><polyline stroke-linecap=round stroke-linejoin=round points="39 26 42 31.5 46 26.5 47 31 53.5 28.5 53.5 31 62 31"><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=1.5s repeatCount=1></animate></polyline><g transform="translate(60,25) rotate(48)"><path d="M4,18 L52,18 L52,30 L4,30 L-3,24 L4,18 Z" fill=var(--bg) stroke-linejoin=round stroke-linecap=round></path><path d="M11,30 L11,19"></path><path d="M41,24 L29,24" stroke-linecap=round></path><rect x=54 y=21.5 width=1 height=5 /></g><path d="M15,35 L21,35" stroke-linecap=square /><path d="M15,65 L21,65" stroke-linecap=square></path></g></svg> </span></a><a class=menu-item href=/link><span><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 100 100" version=1.1><title>link</title><desc>create by lorre.</desc><g stroke=#8A8A8A stroke-width=3 fill=none fill-rule=evenodd><circle cx=50.5 cy=49.5 r=28.5 /><g transform="translate(52, 47)" fill=#8A8A8A stroke-width=2 stroke-linecap=round><path d="M1,5 L13,5"/><path d="M5,5 L5,13"/><path d="M9,5 L9,13"/><circle cx=7 cy=2 r=2 /><rect x=6 y=5.5 width=3 height=4 /><animate attributeName=opacity from=0 to=0.8 dur=0.5s repeatCount=1 /></g><path d="M41,76 C41,75 41,74 42,73 C43,70 48,70 53,72 C55,73 57,75 58,76 C56,77 53,78 50.5,78 C47,78 44,77 41,76 Z"/><path d="M67,26 C73,31 77,38 78,45 C72,45 67,39 67,32 C67,30 67,28 68,27 Z"/><ellipse transform="translate(38, 44) rotate(30) translate(-38, -44) " cx=38.5 cy=44 rx=6.5 ry=8 /><path d="M23,45 C15,47 10,50 10,53 C10,59 28,63 50,63 L50,63 C72,63 90,59 90,53 C90,50 86,48 79,46" transform="translate(50, 54) rotate(-13) translate(-50, -54) "><animate attributeName=stroke-dasharray from="0 100" to="100 160" dur=0.5s repeatCount=1 /></path></g></svg> </span></a><span id=search class=menu-item><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 100 100" version=1.1><title>search</title><desc>create by lorre.</desc><g stroke=#8A8A8A stroke-width=3 fill=none fill-rule=evenodd><path d="M53,63 L53,63 L53,63 L79,63 C82,63 85,65 85,69 C85,72 82,75 79,75 L53,75 L53,75" transform="translate(69, 69) rotate(45) translate(-69, -69) "/><path d="M51,56 C56,53 60,47 60,41.5 C60,35 57,30 53,27" stroke-linecap=round><animate attributeName=stroke-dasharray from="0 100" to="100 100" dur=1.5s repeatCount=1></animate></path><circle cx=41.5 cy=41.5 r=24 /></g></svg></span></nav></header><div id=shade class=wrap><h4 class=s-tit>「 搜索 」</h4><p class=s-sub>你能够搜寻我的一切，除了灵魂。</p><input id=s-txt type=text placeholder=" ʕ·ᴥ·ʔ  use Alt + J / K up and dowm"><div id=s-wrap><script src=/js/search.js path=&#x2F;search.json defer=defer></script></div></div><main id=contain class=wrap><div class=intro><h2 class="title an dl-2"><a href=#>Archlinux安装指北（二）</a></h2><div class="meta an dl-3"><time>Mar 06. 2022</time> <span class=author>by .悬铃木. </span><span class=list><ul class=ca-list><li class=ca-list-item><a class=ca-list-link href=/categories/%E7%AC%94%E8%AE%B0/ >笔记</a></li></ul></span><span>1.4k 字</span></div><details class="toc an dl-4"><summary>目录导航</summary><ol class=t-li><li class="t-li-item t-li-level-1"><a class=t-li-link href=#%E7%A6%81%E7%94%A8-reflector-%E6%9C%8D%E5%8A%A1><span class=t-li-text>禁用 reflector 服务</span></a></li><li class="t-li-item t-li-level-1"><a class=t-li-link href=#%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C><span class=t-li-text>连接网络</span></a><ol class=t-li-child><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E4%BD%BF%E7%94%A8-iwctl-%E8%BF%9B%E8%A1%8C%E8%BF%9E%E6%8E%A5><span class=t-li-text>使用 iwctl 进行连接</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E5%A6%82%E6%9E%9C%E6%97%A0%E7%BA%BF%E7%BD%91%E5%8D%A1%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA><span class=t-li-text>如果无线网卡无法显示</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E8%BF%9E%E9%80%9A%E6%80%A7><span class=t-li-text>测试网络连通性</span></a></li></ol></li><li class="t-li-item t-li-level-1"><a class=t-li-link href=#%E6%9B%B4%E6%96%B0%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%92%9F><span class=t-li-text>更新系统时钟</span></a></li><li class="t-li-item t-li-level-1"><a class=t-li-link href=#%E6%9B%B4%E6%8D%A2%E5%9B%BD%E5%86%85%E8%BD%AF%E4%BB%B6%E4%BB%93%E5%BA%93%E9%95%9C%E5%83%8F%E6%BA%90><span class=t-li-text>更换国内软件仓库镜像源</span></a></li><li class="t-li-item t-li-level-1"><a class=t-li-link href=#%E5%88%86%E5%8C%BA%E5%92%8C%E6%A0%BC%E5%BC%8F%E5%8C%96><span class=t-li-text>分区和格式化</span></a><ol class=t-li-child><li class="t-li-item t-li-level-2"><a class=t-li-link href=#fdisk-%E8%BF%9B%E8%A1%8C%E5%88%86%E5%8C%BA><span class=t-li-text>fdisk 进行分区</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%88%86%E5%8C%BA><span class=t-li-text>格式化分区</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E6%8C%82%E8%BD%BD%E5%88%86%E5%8C%BA><span class=t-li-text>挂载分区</span></a></li></ol></li><li class="t-li-item t-li-level-1"><a class=t-li-link href=#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F><span class=t-li-text>安装系统</span></a><ol class=t-li-child><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E5%86%85%E6%A0%B8><span class=t-li-text>安装基础内核</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E7%94%9F%E6%88%90-fstab-%E6%96%87%E4%BB%B6><span class=t-li-text>生成 fstab 文件</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E5%88%87%E6%8D%A2%E5%88%B0%E6%96%B0%E7%B3%BB%E7%BB%9F%E4%B8%8B><span class=t-li-text>切换到新系统下</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E5%AE%89%E8%A3%85%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD%E6%80%A7%E8%BD%AF%E4%BB%B6><span class=t-li-text>安装其他功能性软件</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E8%AE%BE%E7%BD%AE%E4%B8%BB%E6%9C%BA%E5%90%8D%E4%B8%8E%E6%97%B6%E5%8C%BA><span class=t-li-text>设置主机名与时区</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E8%AE%BE%E7%BD%AE-Locale-%E5%AD%97%E7%AC%A6%E9%9B%86><span class=t-li-text>设置 Locale 字符集</span></a></li><li class="t-li-item t-li-level-2"><a class=t-li-link href=#%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7><span class=t-li-text>设置用户</span></a></li></ol></li></ol></details><div class="cont an dl-5"><blockquote><p>插上U盘开机后，选择第一项回车进入安装环境。</p></blockquote><h1 id=禁用-reflector-服务><a href=#禁用-reflector-服务 class=headerlink title="禁用 reflector 服务"></a>禁用 reflector 服务</h1><ol><li><code>reflector</code> 会自己更新 <code>mirrorlist</code> （软件包管理 <code>pacman</code> 的软件源）。因为地理上造成的网络环境，可能会误删某些有用的源信息。（大清国情所在）<figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">systemctl stop reflector.service<br></code></pre></td></tr></table></figure></li><li>可以通过以下命令查看该服务是否被禁用，<code>q</code>退出<figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">systemctl status reflector.service<br></code></pre></td></tr></table></figure></li></ol><h1 id=连接网络><a href=#连接网络 class=headerlink title=连接网络></a>连接网络</h1><p>arch 的安装必须要求网络环境。如果你有分出的网线（DHCP），正常情况下插上就能联网。以下为无线连接的方式。</p><h2 id=使用-iwctl-进行连接><a href=#使用-iwctl-进行连接 class=headerlink title="使用 iwctl 进行连接"></a>使用 <code>iwctl</code> 进行连接</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment># 进入交互式命令行</span><br>iwctl <br><br><span class=hljs-comment># 列出无线网卡设备名，比如无线网卡看到叫 wlan0</span><br>device list<br><br><span class=hljs-comment># 扫描网络 | 列出所有 wifi 网络</span><br>station wlan0 scan<br>station wlan0 get-networks<br><span class=hljs-comment># 进行连接，注意这里无法输入中文。回车后输入密码即可</span><br>station wlan0 connect wifi-name<br><br><span class=hljs-built_in>exit</span> <span class=hljs-comment># 连接成功后退出</span><br></code></pre></td></tr></table></figure><h2 id=如果无线网卡无法显示><a href=#如果无线网卡无法显示 class=headerlink title=如果无线网卡无法显示></a>如果无线网卡无法显示</h2><p>通过以下命令查看内核是否加载了你的无线网卡驱动。</p><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">lspci -k | grep Nerwork<br></code></pre></td></tr></table></figure><p>如果你的bios没有开启无线网卡开关。</p><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment>#查看无线连接 是否被禁用(blocked: yes)</span><br>rfkill list<br><span class=hljs-comment>#比如无线网卡看到叫 wlan0</span><br>ip <span class=hljs-built_in>link</span> <span class=hljs-built_in>set</span> wlan0 up<br><span class=hljs-comment># 若看到类似`Operation not possible due to RF-kill`的报错，继续尝试`rfkill unblock wifi`来解锁无线网卡。</span><br>rfkill unblock wifi <br></code></pre></td></tr></table></figure><p>部分无线网卡不兼容，请考虑使用有线连接安装。</p><h2 id=测试网络连通性><a href=#测试网络连通性 class=headerlink title=测试网络连通性></a>测试网络连通性</h2><p>通过 <code>ping</code> 命令测试网络连通性：</p><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">ping www.bilibili.com<br></code></pre></td></tr></table></figure><p>如有数据返回，则已联网，与window不同的是，需要按下 <code>ctrl</code> + <code>c</code> 推出 <code>ping</code> 命令。</p><blockquote><p>如果还是无法连接可以使用 <code>ip link</code> 查看网卡设备，使用 <code>ip link set &lt;设备名&gt; up</code> 来激活对应的无线网卡。若还有报错，继续尝试 <code>rfkill unblock wifi</code> 来解锁无线网卡。</p></blockquote><h1 id=更新系统时钟><a href=#更新系统时钟 class=headerlink title=更新系统时钟></a>更新系统时钟</h1><p>使用 <code>timedatectl</code> 确保系统时间是准确的。不是必须，但对于部分程序来说十分重要。</p><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment># 将系统时间与网络时间进行同步</span><br>timedatectl set-ntp <span class=hljs-literal>true</span><br><span class=hljs-comment># 检查服务状态</span><br>timedatectl status<br></code></pre></td></tr></table></figure><h1 id=更换国内软件仓库镜像源><a href=#更换国内软件仓库镜像源 class=headerlink title=更换国内软件仓库镜像源></a>更换国内软件仓库镜像源</h1><p>使用 <code>vim</code> 编辑器修改 <br><code>/etc/pacman.d</code> 按 <code>/</code> 输入 <code>mirritlist</code> 找到 <code>/etc/pacman.d/mirrorlist</code> （回车后可以用大小写 <code>n</code> 键来上下搜索），按<code>g</code> + <code>d</code> 进入修改文件。将 <code>pacman</code> 软件仓库源更换为国内软件仓库镜像源。</p><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">vim /etc/pacman.d/mirrorlist<br></code></pre></td></tr></table></figure><p>推荐的镜像源如下</p><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment># 中国科学技术大学开源镜像站</span><br>Server = https://mirrors.ustc.edu.cn/archlinux/<span class=hljs-variable>$repo</span>/os/<span class=hljs-variable>$arch</span> <br><span class=hljs-comment># 清华大学开源软件镜像站</span><br>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/<span class=hljs-variable>$repo</span>/os/<span class=hljs-variable>$arch</span><br><span class=hljs-comment># 华为开源镜像站</span><br>Server = https://repo.huaweicloud.com/archlinux/<span class=hljs-variable>$repo</span>/os/<span class=hljs-variable>$arch</span><br><span class=hljs-comment># 兰州大学开源镜像站</span><br>Server = http://mirror.lzu.edu.cn/archlinux/<span class=hljs-variable>$repo</span>/os/<span class=hljs-variable>$arch</span><br><br></code></pre></td></tr></table></figure><h1 id=分区和格式化><a href=#分区和格式化 class=headerlink title=分区和格式化></a>分区和格式化</h1><blockquote><p>请做好备份，谨慎输入命令。</p></blockquote><h2 id=fdisk-进行分区><a href=#fdisk-进行分区 class=headerlink title="fdisk 进行分区"></a><code>fdisk</code> 进行分区</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">fdisk -l <span class=hljs-comment># 列出设备</span><br>fdisk /dev/&lt;设备名&gt; <span class=hljs-comment># 选中硬盘 （如果）</span><br><span class=hljs-comment># n 新建</span><br><span class=hljs-comment># p 列出</span><br><span class=hljs-comment># d 移除</span><br><span class=hljs-comment># w 写入</span><br><span class=hljs-comment># q 退出</span><br></code></pre></td></tr></table></figure><p>按照提示操作即可，分区配置大致如下。</p><ul><li><code>sda1</code>—— <code>/boot</code> EFI分区可跟 <code>widnows</code> 共用</li><li><code>sda2</code>—— <code>/</code> 根目录 <code>&gt;=128GB</code></li><li><code>sda3</code> —— SWAP分区 <code>&gt;= 电脑实际运行内存的60%</code>（为配置休眠准备）</li></ul><h2 id=格式化分区><a href=#格式化分区 class=headerlink title=格式化分区></a>格式化分区</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment># 如果已有window系统，则不需要，否则会把widnow的启动项删掉</span><br>mkfs.fat -F32 /dev/sda1<br><span class=hljs-comment># 也可以选择ext4</span><br>mkfs.btrfs /dev/sda2<br><span class=hljs-comment># swap</span><br>mkfswap /dev/sda3<br></code></pre></td></tr></table></figure><h2 id=挂载分区><a href=#挂载分区 class=headerlink title=挂载分区></a>挂载分区</h2><blockquote><p>挂载是有顺序的，需要从根目录开始挂载。</p></blockquote><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">mount -t btrfs -o subvol=/@,compress=zstd /dev/sda2 /mnt<br><br><span class=hljs-comment># 创建 /home 目录 | 挂载</span><br><span class=hljs-built_in>mkdir</span> /mnt/home<br>mount -t btrfs -o subvol=/@home,compress=zstd /dev/sdxn /mnt/home<br><br><span class=hljs-comment># 创建 /boot 目录 | 挂载</span><br><span class=hljs-built_in>mkdir</span> -p /mnt/boot<br>mount /dev/sda1 /mnt/boot<br><br><span class=hljs-comment># 挂载交换分区</span><br>swapon /dev/sda3<br><br><span class=hljs-built_in>df</span> -h <span class=hljs-comment># 查看挂载情况</span><br>free -h <span class=hljs-comment># Swap 分区挂载情况</span><br></code></pre></td></tr></table></figure><h1 id=安装系统><a href=#安装系统 class=headerlink title=安装系统></a>安装系统</h1><h2 id=安装基础内核><a href=#安装基础内核 class=headerlink title=安装基础内核></a>安装基础内核</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">pacstrap /mnt base base-devel linux linux-firmware btrfs-progs<br><span class=hljs-comment># 如果使用btrfs文件系统，额外安装一个 `btrfs-progs` 包</span><br></code></pre></td></tr></table></figure><blockquote><p>如果提示 GPG证书错误，可能是因为使用的不是最新的镜像，可以通过更新 <code>archlinux-keyring</code> 解决。</p></blockquote><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">pacman -S archlinux-keyring<br></code></pre></td></tr></table></figure><h2 id=生成-fstab-文件><a href=#生成-fstab-文件 class=headerlink title="生成 fstab 文件"></a>生成 fstab 文件</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">genfstab -U /mnt &gt; /mnt/etc/fstab<br></code></pre></td></tr></table></figure><h2 id=切换到新系统下><a href=#切换到新系统下 class=headerlink title=切换到新系统下></a>切换到新系统下</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">arch-chroot /mnt<br></code></pre></td></tr></table></figure><h2 id=安装其他功能性软件><a href=#安装其他功能性软件 class=headerlink title=安装其他功能性软件></a>安装其他功能性软件</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment># 网络管理 很重要，否则开机没网</span><br>pacman -S networkmanager netctl dhcpcd wireless_tools wpa_supplicant<br><br><span class=hljs-comment># vim 编辑器以及 sudo 权限管理器</span><br>pacman -S vim sudo<br><br><span class=hljs-comment># 芯片制造商的微码</span><br>pacman -S intel-ucode <span class=hljs-comment># Intel</span><br>pacman -S amd-ucode <span class=hljs-comment># AMD</span><br></code></pre></td></tr></table></figure><h2 id=设置主机名与时区><a href=#设置主机名与时区 class=headerlink title=设置主机名与时区></a>设置主机名与时区</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash"><span class=hljs-comment># i 键入你想要等等主机名，:wq 保存</span><br>vim /etc/hostname<br><br><span class=hljs-comment># 加入以下内容</span><br>vim /etc/hosts<br>127.0.0.1   localhost<br>::1         localhost<br>127.0.1.1   myarch.localdomain myarch<br><br><span class=hljs-comment># 设置时区 （ps： 没有北京）</span><br><span class=hljs-built_in>ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br>hwclock --systohc <span class=hljs-comment># 把系统时间同步到硬件时间</span><br></code></pre></td></tr></table></figure><h2 id=设置-Locale-字符集><a href=#设置-Locale-字符集 class=headerlink title="设置 Locale 字符集"></a>设置 Locale 字符集</h2><ol><li><code>vim /etc/locale.gen</code> ，<code>/</code> 找到 <code>es_US.UTF-8 UTF-8</code> 以及 <code>zh_CN.UTF-8 UTF-8</code> ，去掉行前注释符 <code>#</code>。</li><li><code>locale-gen</code> 生成 <code>locale-gen</code></li><li><code>echo &#39;LANG=en_US.UTF-8&#39; &gt; /etc/locale.conf</code> 设置系统字符集。（不推荐中文，会导致tty乱码）</li></ol><h2 id=设置用户><a href=#设置用户 class=headerlink title=设置用户></a>设置用户</h2><figure class="highlight bash">
    <div class="cp-wrap" lang="bash">
      <div class="cp-head">
      <span class="cp-lang">bash</span>
      <span class="cp-code">COPY</span>
      </div>
    </div>
    <table><tr><td class=code><pre><code class="hljs bash">passwd root <span class=hljs-comment># 给root创建密码</span><br>useradd -m -G wheel -s /bin/bash &lt;username&gt;<br><span class=hljs-comment># -m 创建主目录</span><br><span class=hljs-comment># -G 将用户添加到另一个组</span><br><span class=hljs-comment># -s 指定默认登陆使用的shell</span><br><span class=hljs-comment>## wheel 组是一种特殊类型的组，用于控制谁可以访问sudo命令</span><br><br><span class=hljs-comment># 配置访问权限</span><br>vim /etc/sudoers<br>%wheel ALL=(ALL) ALL <span class=hljs-comment># 取消注释</span><br><br><span class=hljs-comment># 切换到新用户</span><br>su &lt;username&gt;<br></code></pre></td></tr></table></figure><blockquote><p>至此，基础的arch已经安装完成，通过 <code>reboot</code> 重启，<code>shutdown now</code>关机</p></blockquote></div><div class="list an dl-6" style=font-size:15px;font-weight:700><ul class=tag-list itemprop=keywords><li class=tag-list-item><a class=tag-list-link href=/tags/archlinux/ rel=tag>Archlinux</a><span class=tag-list-count>3</span></li></ul></div><div class="more an dl-7"><div class=prev><a href=/%E7%AC%94%E8%AE%B0/20230307Archlinux%E5%AE%89%E8%A3%85%E6%8C%87%E5%8C%97%EF%BC%88%E4%B8%89%EF%BC%89/ ><div class=more-icon><svg viewBox="0 0 1024 1024" width=24 height=24><path d="M589.088 790.624L310.464 512l278.624-278.624 45.248 45.248L400.96 512l233.376 233.376z" fill=#808080></path></svg></div><div><div class=nav-label>Previous Post</div><div class=nav-title>Archlinux安装指北（三）</div></div></a></div><div class=next><a href=/%E7%AC%94%E8%AE%B0/20220306Archlinux%E5%AE%89%E8%A3%85%E6%8C%87%E5%8C%97%EF%BC%88%E4%B8%80%EF%BC%89/ ><div><div class=nav-label>Next Post</div><div class=nav-title>Archlinux安装指北（一）</div></div><div class=more-icon><svg viewBox="0 0 1024 1024" width=24 height=24><path d="M434.944 790.624l-45.248-45.248L623.04 512l-233.376-233.376 45.248-45.248L713.568 512z" fill=#808080></path></svg></div></a></div></div></div></main><footer class=wrap><ul class="list item"><audio id=bg-au style=display:none src=/music/like_a_star.mp3></audio><li id=ch-au>悬铃木 🍂</li><li id=sw-au>播放</li><li><a title=RSS订阅 href=/atom.xml target=_blank>订阅</a></li><li id=""><a title=小火车呼噜噜 href=https://travellings.link target=_blank rel="noopener noreferrer">开往</a></li><li id=sw-th>开灯</li></ul></footer><div class=script><script>function LoadPjax(){window.pjax=new Pjax({selectors:["head title",'head meta[name="keywords"]','head meta[name="description"]',"#contain"],cache:!0,cacheBust:!1})}function changeActive(){document.querySelectorAll("nav>a").forEach(e=>{e.href.split("/").pop()===window.location.pathname.split("/")[1]?e.classList.add("active"):e.classList.remove("active")})}function copyCode(){var e=document.querySelector(".cont");e&&e.addEventListener("click",e=>{const t=e.target;if(t.classList.contains("cp-code")){const e=t.parentElement.parentElement.nextElementSibling;var n,o;"TABLE"===e.tagName&&(n=e.querySelector(".code"),(o=window.getSelection()).selectAllChildren(n),document.execCommand("copy"),o.removeAllRanges(),t.innerText="COPIED",setTimeout(function(){t.innerText="COPY"},2e3))}})}LoadPjax(),copyCode(),document.addEventListener("pjax:send",()=>{document.body.classList.remove("search"),document.getElementById("load").classList.add("show")}),document.addEventListener("pjax:complete",()=>{setTimeout(()=>{document.getElementById("load").classList.remove("show"),changeActive(),copyCode()},200)}),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404/")})</script></div></div></body></html>